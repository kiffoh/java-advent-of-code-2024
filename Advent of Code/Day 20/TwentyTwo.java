
import java.awt.Point;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;
import java.util.PriorityQueue;
import java.util.Queue;
import java.util.Set;
import java.util.TreeMap;

class TwentyTwo {

    // static String longInput = """
    // ###############
    // #...#...#.....#
    // #.#.#.#.#.###.#
    // #S#...#.#.#...#
    // #######.#.#.###
    // #######.#.#...#
    // #######.#.###.#
    // ###..E#...#...#
    // ###.#######.###
    // #...###...#...#
    // #.#####.#.###.#
    // #.#...#.#.#...#
    // #.#.#.#.#.#.###
    // #...#...#...###
    // ###############
    // """;

    static String longInput = """
    #############################################################################################################################################
    #...#.....#####.......#.....#...#...#...#...#.....#...#...###...#.......###...###...#...#####...#...###.......#...###...#...#...###.....#...#
    #.#.#.###.#####.#####.#.###.#.#.#.#.#.#.#.#.#.###.#.#.#.#.###.#.#.#####.###.#.###.#.#.#.#####.#.#.#.###.#####.#.#.###.#.#.#.#.#.###.###.#.#.#
    #.#.#...#...#...#.....#...#...#...#.#.#.#.#.#.#...#.#.#.#.#...#.#...#...#...#.....#.#.#...#...#.#.#...#...#...#.#...#.#...#.#.#...#...#.#.#.#
    #.#.###.###.#.###.#######.#########.#.#.#.#.#.#.###.#.#.#.#.###.###.#.###.#########.#.###.#.###.#.###.###.#.###.###.#.#####.#.###.###.#.#.#.#
    #.#.....#...#...#.......#.....#.....#.#...#.#.#...#.#.#.#...#...#...#...#.........#...#...#...#.#.#...#...#.#...#...#...#...#.#...#...#.#.#.#
    #.#######.#####.#######.#####.#.#####.#####.#.###.#.#.#.#####.###.#####.#########.#####.#####.#.#.#.###.###.#.###.#####.#.###.#.###.###.#.#.#
    #.......#.#.....#.......#...#.#.......#.....#.#...#.#.#.#...#...#...#...#...#...#.....#...#...#.#.#.###.#...#.#...#####.#...#.#...#...#.#.#.#
    #######.#.#.#####.#######.#.#.#########.#####.#.###.#.#.#.#.###.###.#.###.#.#.#.#####.###.#.###.#.#.###.#.###.#.#######.###.#.###.###.#.#.#.#
    #.......#.#...#...###...#.#.#.#.......#.###...#...#.#.#...#...#.....#...#.#.#.#.#...#...#.#.#...#.#.....#...#.#.....#...#...#...#...#.#.#.#.#
    #.#######.###.#.#####.#.#.#.#.#.#####.#.###.#####.#.#.#######.#########.#.#.#.#.#.#.###.#.#.#.###.#########.#.#####.#.###.#####.###.#.#.#.#.#
    #.......#.#...#.....#.#.#.#.#...#.....#...#...#...#.#.###...#.........#.#.#...#.#.#...#.#.#.#...#.....#.....#.#.....#.#...#...#...#...#...#.#
    #######.#.#.#######.#.#.#.#.#####.#######.###.#.###.#.###.#.#########.#.#.#####.#.###.#.#.#.###.#####.#.#####.#.#####.#.###.#.###.#########.#
    #.......#.#...#.....#.#...#...###.......#...#.#.#...#.#...#...###.....#.#.#.....#.#...#.#.#...#.......#.....#.#...#...#.#...#...#.....#.....#
    #.#######.###.#.#####.#######.#########.###.#.#.#.###.#.#####.###.#####.#.#.#####.#.###.#.###.#############.#.###.#.###.#.#####.#####.#.#####
    #.#.....#.....#.....#.......#.#...###...#...#.#.#...#.#.....#...#.#.....#.#.....#.#.#...#.#...#.............#...#.#.#...#.#.....#...#.#.....#
    #.#.###.###########.#######.#.#.#.###.###.###.#.###.#.#####.###.#.#.#####.#####.#.#.#.###.#.###.###############.#.#.#.###.#.#####.#.#.#####.#
    #...###.......#.....#...#...#.#.#...#.#...###.#.#...#...#...#...#.#...#...#.....#.#.#...#.#...#.....#...#...###.#...#.....#.......#...#.....#
    #############.#.#####.#.#.###.#.###.#.#.#####.#.#.#####.#.###.###.###.#.###.#####.#.###.#.###.#####.#.#.#.#.###.#######################.#####
    #...###.......#...###.#.#...#.#...#.#.#.#...#.#.#...#...#...#...#...#.#.#...#...#.#...#.#.#...#...#...#.#.#.....#.......#...#.....#...#.....#
    #.#.###.#########.###.#.###.#.###.#.#.#.#.#.#.#.###.#.#####.###.###.#.#.#.###.#.#.###.#.#.#.###.#.#####.#.#######.#####.#.#.#.###.#.#.#####.#
    #.#...#.........#...#.#.#...#...#.#...#.#.#...#.###.#.....#.#...###.#.#.#.....#.#...#...#...#...#.....#.#.....#...#...#...#...###...#.#.....#
    #.###.#########.###.#.#.#.#####.#.#####.#.#####.###.#####.#.#.#####.#.#.#######.###.#########.#######.#.#####.#.###.#.###############.#.#####
    #...#.#...#.....#...#.#.#...#...#...#...#.....#...#.....#...#.#...#.#.#.#.......###.#...#...#...#...#...###...#.#...#.#.....#.....###.#.....#
    ###.#.#.#.#.#####.###.#.###.#.#####.#.#######.###.#####.#####.#.#.#.#.#.#.#########.#.#.#.#.###.#.#.#######.###.#.###.#.###.#.###.###.#####.#
    #...#...#.#.....#.....#.....#.#...#.#.#...###...#...###.....#.#.#.#.#.#.#.#...#...#...#...#...#...#...#...#...#.#.#...#...#.#.#...#...#...#.#
    #.#######.#####.#############.#.#.#.#.#.#.#####.###.#######.#.#.#.#.#.#.#.#.#.#.#.###########.#######.#.#.###.#.#.#.#####.#.#.#.###.###.#.#.#
    #.......#.......#...........#.#.#.#.#.#.#.#...#.#...#.....#.#.#.#...#.#.#.#.#.#.#...###...#...#.......#.#.#...#.#.#.#.....#...#.###...#.#...#
    #######.#########.#########.#.#.#.#.#.#.#.#.#.#.#.###.###.#.#.#.#####.#.#.#.#.#.###.###.#.#.###.#######.#.#.###.#.#.#.#########.#####.#.#####
    #.....#...........#.........#.#.#.#.#.#.#.#.#...#.###...#.#.#.#.#.....#.#.#.#.#...#...#.#.#...#.#...#...#...#...#.#...#...#...#...###...#...#
    #.###.#############.#########.#.#.#.#.#.#.#.#####.#####.#.#.#.#.#.#####.#.#.#.###.###.#.#.###.#.#.#.#.#######.###.#####.#.#.#.###.#######.#.#
    #...#.............#.....#...#.#.#.#.#.#.#.#.....#...#...#.#.#.#.#...#...#...#.###...#.#.#...#.#...#.#.#.......#...#.....#...#...#.........#.#
    ###.#############.#####.#.#.#.#.#.#.#.#.#.#####.###.#.###.#.#.#.###.#.#######.#####.#.#.###.#.#####.#.#.#######.###.###########.###########.#
    #...#...#.......#...###...#.#.#.#.#.#.#.#.#...#...#.#...#.#.#.#.#...#.....#...#...#.#.#.#...#.#.....#.#.###.....#...###.......#...#...#.....#
    #.###.#.#.#####.###.#######.#.#.#.#.#.#.#.#.#.###.#.###.#.#.#.#.#.#######.#.###.#.#.#.#.#.###.#.#####.#.###.#####.#####.#####.###.#.#.#.#####
    #.....#...#...#...#.#...#...#...#...#.#.#...#.#...#.#...#.#.#.#.#.#.....#.#...#.#.#.#.#.#...#.#.#...#.#...#.#...#.....#.....#...#...#...#...#
    ###########.#.###.#.#.#.#.###########.#.#####.#.###.#.###.#.#.#.#.#.###.#.###.#.#.#.#.#.###.#.#.#.#.#.###.#.#.#.#####.#####.###.#########.#.#
    #.....###...#.....#...#...#.........#.#...#...#.###.#.###...#.#.#...#...#...#.#.#.#.#.#.###.#.#.#.#.#...#...#.#.......#...#.#...###...###.#.#
    #.###.###.#################.#######.#.###.#.###.###.#.#######.#.#####.#####.#.#.#.#.#.#.###.#.#.#.#.###.#####.#########.#.#.#.#####.#.###.#.#
    #...#.....#...#...........#.#.......#.#...#...#.#...#.....#...#...#...#...#.#.#.#...#.#.#...#.#.#.#.#...#...#...#...#...#...#.#...#.#.....#.#
    ###.#######.#.#.#########.#.#.#######.#.#####.#.#.#######.#.#####.#.###.#.#.#.#.#####.#.#.###.#.#.#.#.###.#.###.#.#.#.#######.#.#.#.#######.#
    #...#.......#...#.......#...#.......#.#...#...#.#.#...#...#...#...#...#.#.#.#.#...#...#.#.....#...#.#.#...#.....#.#.#.#.....#...#...#.....#.#
    #.###.###########.#####.###########.#.###.#.###.#.#.#.#.#####.#.#####.#.#.#.#.###.#.###.###########.#.#.#########.#.#.#.###.#########.###.#.#
    #.....#...#...###.....#.....#.......#.....#.....#...#.#.#...#...#.....#.#.#.#...#.#.#...#.....#...#...#...........#...#...#...........#...#.#
    #######.#.#.#.#######.#####.#.#######################.#.#.#.#####.#####.#.#.###.#.#.#.###.###.#.#.#######################.#############.###.#
    #.......#...#...###...#...#...#.............#...###...#...#.....#...#...#.#.#...#.#.#...#...#...#.................#.....#.....#...#...#.....#
    #.#############.###.###.#.#####.###########.#.#.###.###########.###.#.###.#.#.###.#.###.###.#####################.#.###.#####.#.#.#.#.#######
    #.............#.#...#...#.......###.......#...#...#.....#...#...#...#.#...#.#...#.#.#...###...#...#.........#...#...#...#.....#.#...#...#...#
    #############.#.#.###.#############.#####.#######.#####.#.#.#.###.###.#.###.###.#.#.#.#######.#.#.#.#######.#.#.#####.###.#####.#######.#.#.#
    #.............#...#...#.......#.....#...#.......#.....#...#.#...#...#.#.#...#...#.#.#.....###...#...#.......#.#.#...#.....#...#.#.......#.#.#
    #.#################.###.#####.#.#####.#.#######.#####.#####.###.###.#.#.#.###.###.#.#####.###########.#######.#.#.#.#######.#.#.#.#######.#.#
    #.....#...#.......#.#...#...#.#.....#.#.....#...#...#.....#...#.###.#.#.#...#.#...#.......#...........#...#...#...#.......#.#.#.#.###.....#.#
    #####.#.#.#.#####.#.#.###.#.#.#####.#.#####.#.###.#.#####.###.#.###.#.#.###.#.#.###########.###########.#.#.#############.#.#.#.#.###.#####.#
    #...#...#...#.....#.#.#...#.#.......#.#.....#.....#...#...#...#...#...#.#...#.#.#...........#...........#...#...........#...#...#.....#.....#
    #.#.#########.#####.#.#.###.#########.#.#############.#.###.#####.#####.#.###.#.#.###########.###############.#########.###############.#####
    #.#.###...###.......#.#.###...........#.###...###...#...###.....#...#...#.###...#.............#.............#.......#...#...............#...#
    #.#.###.#.###########.#.###############.###.#.###.#.###########.###.#.###.#####################.###########.#######.#.###.###############.#.#
    #.#.#...#.....#.....#...#.............#.....#.....#.........###...#.#...#...###.....###.......#.....#.....#...#...#.#.....#.......#.....#.#.#
    #.#.#.#######.#.###.#####.###########.#####################.#####.#.###.###.###.###.###.#####.#####.#.###.###.#.#.#.#######.#####.#.###.#.#.#
    #.#.#.....#...#...#...#...#.....#...#.............#.......#...#...#...#...#...#...#...#.....#.#...#...#...###...#.#.........#.....#...#...#.#
    #.#.#####.#.#####.###.#.###.###.#.#.#############.#.#####.###.#.#####.###.###.###.###.#####.#.#.#.#####.#########.###########.#######.#####.#
    #.#.###...#...###.#...#.....###...#.............#.#.....#.....#.......###...#...#...#.......#...#.#...#.........#.#.....#...#.........#...#.#
    #.#.###.#####.###.#.###########################.#.#####.###################.###.###.#############.#.#.#########.#.#.###.#.#.###########.#.#.#
    #.#.....#...#.....#.#...#.......................#.#...#.................###.....#...#...#.......#...#...#.......#...###...#.#...#...#...#.#.#
    #.#######.#.#######.#.#.#.#######################.#.#.#################.#########.###.#.#.#####.#######.#.#################.#.#.#.#.#.###.#.#
    #...#.....#.......#.#.#.#.#...................###...#...#...............#...#...#.#...#...#...#.......#.#.................#...#.#.#...###...#
    ###.#.###########.#.#.#.#.#.#################.#########.#.###############.#.#.#.#.#.#######.#.#######.#.#################.#####.#.###########
    ###.#...#.........#...#.#...###.......#...#...#...#...#...###########.....#...#.#...#...#...#...#.....#.............#...#.....#.#...........#
    ###.###.#.#############.#######.#####.#.#.#.###.#.#.#.###############.#########.#####.#.#.#####.#.#################.#.#.#####.#.###########.#
    #...#...#.#...#...#...#.#.......#...#...#.#.....#...#.....###########...#.......#.....#...#...#...#...#...........#...#.......#.............#
    #.###.###.#.#.#.#.#.#.#.#.#######.#.#####.###############.#############.#.#######.#########.#.#####.#.#.#########.###########################
    #...#.#...#.#...#...#.#...#.....#.#.#...#.....#...#.......###########...#.#.....#...........#...#...#.#.#.........#...#...#.........#...#...#
    ###.#.#.###.#########.#####.###.#.#.#.#.#####.#.#.#.#################.###.#.###.###############.#.###.#.#.#########.#.#.#.#.#######.#.#.#.#.#
    ###...#.....#...#...#.#.....###...#...#.....#.#.#.#...###############...#.#.#...###...#.......#.#.###...#...........#.#.#...#.......#.#.#.#.#
    #############.#.#.#.#.#.###################.#.#.#.###.#################.#.#.#.#####.#.#.#####.#.#.###################.#.#####.#######.#.#.#.#
    #...........#.#...#...#.#...................#...#...#.#################.#.#.#.#...#.#...#...#...#.#...................#.#.....#...#...#...#.#
    #.#########.#.#########.#.#########################.#.#################.#.#.#.#.#.#.#####.#.#####.#.###################.#.#####.#.#.#######.#
    #.........#...#...#...#.#...........#...........#...#.#################.#...#...#.#.......#.....#.#.......#.......#...#.#.#...#.#...#...#...#
    #########.#####.#.#.#.#.###########.#.#########.#.###.#################.#########.#############.#.#######.#.#####.#.#.#.#.#.#.#.#####.#.#.###
    #.....###.......#...#.#.#.........#...#.........#.#...#################.#.........###...#.......#.#...###...#.....#.#.#.#...#...#.....#...###
    #.###.###############.#.#.#######.#####.#########.#.###################.#.###########.#.#.#######.#.#.#######.#####.#.#.#########.###########
    #...#.....#...#...###...#.......#.....#.........#.#.#################S..#.........#...#...#...#...#.#...#...#.......#...#...#.....#.....#...#
    ###.#####.#.#.#.#.#############.#####.#########.#.#.#############################.#.#######.#.#.###.###.#.#.#############.#.#.#####.###.#.#.#
    ###.....#...#...#.......#.....#.....#.#...#...#.#...###############.......#...#...#.......#.#...###...#...#.........#...#.#.#.....#.#...#.#.#
    #######.###############.#.###.#####.#.#.#.#.#.#.###################.#####.#.#.#.#########.#.#########.#############.#.#.#.#.#####.#.#.###.#.#
    #...###.........#.......#...#.#.....#...#...#...###...#########.....#...#...#...###.....#.#...#.....#.#...........#.#.#...#.#.....#.#.#...#.#
    #.#.###########.#.#########.#.#.###################.#.#########.#####.#.###########.###.#.###.#.###.#.#.#########.#.#.#####.#.#####.#.#.###.#
    #.#.#...#.......#.#.....#...#...#...........###...#.#.#########...#...#...#.......#...#.#.#...#...#...#.#.....#...#...###...#.......#...#...#
    #.#.#.#.#.#######.#.###.#.#######.#########.###.#.#.#.###########.#.#####.#.#####.###.#.#.#.#####.#####.#.###.#.#########.###############.###
    #.#...#.#.......#.#.#...#...#.....#.........#...#...#.#########...#...#...#.#.....#...#.#...#...#.#.....#...#...#...#...#...#...#...#.....###
    #.#####.#######.#.#.#.#####.#.#####.#########.#######.#########.#####.#.###.#.#####.###.#####.#.#.#.#######.#####.#.#.#.###.#.#.#.#.#.#######
    #.#...#.........#.#.#...#...#...#...#.......#.......#...#######...###.#...#.#.....#...#...#...#.#.#.#.......#.....#...#.###...#...#.#.......#
    #.#.#.###########.#.###.#.#####.#.###.#####.#######.###.#########.###.###.#.#####.###.###.#.###.#.#.#.#######.#########.###########.#######.#
    #...#.#...#.....#...#...#.......#...#.#.....#...###...#.#######...#...#...#.#.....###.#...#...#.#...#.....#...#...#.....#...#...###.........#
    #####.#.#.#.###.#####.#############.#.#.#####.#.#####.#.#######.###.###.###.#.#######.#.#####.#.#########.#.###.#.#.#####.#.#.#.#############
    #.....#.#...#...#...#...#.....#...#...#...#...#...###.#.#######.....#...#...#.....#...#...#...#.#...#.....#.#...#.#.#...#.#...#.#...........#
    #.#####.#####.###.#.###.#.###.#.#.#######.#.#####.###.#.#############.###.#######.#.#####.#.###.#.#.#.#####.#.###.#.#.#.#.#####.#.#########.#
    #.......#...#.....#...#.#.#...#.#.......#...#.....#...#.#...#########.....#...#...#.#.....#...#...#.#.......#...#...#.#...#.....#.#.........#
    #########.#.#########.#.#.#.###.#######.#####.#####.###.#.#.###############.#.#.###.#.#######.#####.###########.#####.#####.#####.#.#########
    #...###...#...........#...#.###.......#.......#...#...#.#.#...#######.......#...#...#.###...#...#...#...#.....#.......#...#.......#.........#
    #.#.###.###################.#########.#########.#.###.#.#.###.#######.###########.###.###.#.###.#.###.#.#.###.#########.#.#################.#
    #.#.#...#.....#.......#...#...........#...#...#.#.#...#.#...#...#####.#.....#...#...#...#.#.#...#.#...#.#.###...#...#...#...#...#...#...#...#
    #.#.#.###.###.#.#####.#.#.#############.#.#.#.#.#.#.###.###.###.#####.#.###.#.#.###.###.#.#.#.###.#.###.#.#####.#.#.#.#####.#.#.#.#.#.#.#.###
    #.#.#.#...###...#.....#.#...#...#...###.#.#.#.#.#.#...#.###.#...###...#.#...#.#.###...#.#.#.#...#.#...#.#.....#.#.#.#.....#.#.#...#...#...###
    #.#.#.#.#########.#####.###.#.#.#.#.###.#.#.#.#.#.###.#.###.#.#####.###.#.###.#.#####.#.#.#.###.#.###.#.#####.#.#.#.#####.#.#.###############
    #.#...#.###.......#.....###...#...#...#.#.#.#.#.#.#...#.#...#.#..E#.#...#...#.#...#...#.#.#.#...#.#...#.......#...#.....#.#...#.....#...#...#
    #.#####.###.#######.#################.#.#.#.#.#.#.#.###.#.###.#.###.#.#####.#.###.#.###.#.#.#.###.#.###################.#.#####.###.#.#.#.#.#
    #...#...#...#.....#...#...............#.#...#.#.#.#.#...#...#.#...#...#...#.#.#...#.###.#.#.#.#...#.........#.........#.#.....#...#...#.#.#.#
    ###.#.###.###.###.###.#.###############.#####.#.#.#.#.#####.#.###.#####.#.#.#.#.###.###.#.#.#.#.###########.#.#######.#.#####.###.#####.#.#.#
    ###.#.###.#...###.....#...#...#...#...#...#...#.#.#.#.....#.#.#...###...#...#.#...#...#.#.#.#.#...#.......#...#...#...#.#...#.....#.....#.#.#
    ###.#.###.#.#############.#.#.#.#.#.#.###.#.###.#.#.#####.#.#.#.#####.#######.###.###.#.#.#.#.###.#.#####.#####.#.#.###.#.#.#######.#####.#.#
    #...#.#...#.#.............#.#.#.#...#.#...#.#...#.#.....#...#.#...#...#.....#.#...#...#...#...###.#.#.....#...#.#.#...#...#.......#.....#.#.#
    #.###.#.###.#.#############.#.#.#####.#.###.#.###.#####.#####.###.#.###.###.#.#.###.#############.#.#.#####.#.#.#.###.###########.#####.#.#.#
    #.....#.#...#...#.....#.....#.#...#...#...#.#.#...#...#.....#...#.#...#.#...#.#...#...###...#.....#.#.#...#.#...#.....#.......###.#.....#.#.#
    #######.#.#####.#.###.#.#####.###.#.#####.#.#.#.###.#.#####.###.#.###.#.#.###.###.###.###.#.#.#####.#.#.#.#.###########.#####.###.#.#####.#.#
    ###.....#.....#.#...#.#.#...#.....#...#...#...#.#...#...#...#...#.#...#.#...#...#...#.....#.#.....#.#.#.#.#.............#...#...#.#.......#.#
    ###.#########.#.###.#.#.#.#.#########.#.#######.#.#####.#.###.###.#.###.###.###.###.#######.#####.#.#.#.#.###############.#.###.#.#########.#
    #...#...#.....#...#.#...#.#...........#.#...#...#...###.#.###...#.#...#.###...#.###...#...#...#...#.#...#...#.......#.....#.#...#...#...#...#
    #.###.#.#.#######.#.#####.#############.#.#.#.#####.###.#.#####.#.###.#.#####.#.#####.#.#.###.#.###.#######.#.#####.#.#####.#.#####.#.#.#.###
    #.....#.#...#.....#.#.....#...#...#...#...#.#.#.....#...#...#...#.#...#...###.#...#...#.#.#...#.....###.....#.....#.#.....#.#.###...#.#.#...#
    #######.###.#.#####.#.#####.#.#.#.#.#.#####.#.#.#####.#####.#.###.#.#####.###.###.#.###.#.#.###########.#########.#.#####.#.#.###.###.#.###.#
    #.......#...#...#...#...#...#...#.#.#...#...#.#.....#...#...#.#...#.#...#...#.#...#.#...#.#.......#.....#...#...#.#.......#...#...#...#.#...#
    #.#######.#####.#.#####.#.#######.#.###.#.###.#####.###.#.###.#.###.#.#.###.#.#.###.#.###.#######.#.#####.#.#.#.#.#############.###.###.#.###
    #.#.....#.#...#...#...#...###.....#.#...#.#...#...#...#.#.#...#...#.#.#...#.#.#.###.#...#...#.....#...#...#...#.#.............#...#...#.#.###
    #.#.###.#.#.#.#####.#.#######.#####.#.###.#.###.#.###.#.#.#.#####.#.#.###.#.#.#.###.###.###.#.#######.#.#######.#############.###.###.#.#.###
    #.#.#...#.#.#.......#.......#.....#.#...#.#.#...#...#.#.#.#...#...#.#.#...#.#.#.#...#...#...#...#.....#.....#...#...#.........###.#...#.#...#
    #.#.#.###.#.###############.#####.#.###.#.#.#.#####.#.#.#.###.#.###.#.#.###.#.#.#.###.###.#####.#.#########.#.###.#.#.###########.#.###.###.#
    #.#.#.#...#.#...#.....#...#.......#.###...#.#.....#...#.#.#...#.###...#...#.#.#.#.#...#...#...#.#...#.....#.#.#...#.#.....#.....#.#...#.#...#
    #.#.#.#.###.#.#.#.###.#.#.#########.#######.#####.#####.#.#.###.#########.#.#.#.#.#.###.###.#.#.###.#.###.#.#.#.###.#####.#.###.#.###.#.#.###
    #.#.#.#.###...#...###...#...#.....#.......#.#.....###...#.#...#.....###...#.#.#.#.#.###...#.#.#...#...#...#.#.#...#.....#...#...#...#.#...###
    #.#.#.#.###################.#.###.#######.#.#.#######.###.###.#####.###.###.#.#.#.#.#####.#.#.###.#####.###.#.###.#####.#####.#####.#.#######
    #.#.#.#.#...................#.###...#...#.#.#.......#.#...#...#.....#...#...#.#.#.#.#.....#.#...#.....#...#.#...#.....#.#...#...#...#...#...#
    #.#.#.#.#.###################.#####.#.#.#.#.#######.#.#.###.###.#####.###.###.#.#.#.#.#####.###.#####.###.#.###.#####.#.#.#.###.#.#####.#.#.#
    #.#.#.#.#.......#...#...#.....#.....#.#.#.#.#.......#.#...#...#.....#.#...#...#.#...#.#...#...#.....#...#.#...#.#...#.#.#.#.....#.....#...#.#
    #.#.#.#.#######.#.#.#.#.#.#####.#####.#.#.#.#.#######.###.###.#####.#.#.###.###.#####.#.#.###.#####.###.#.###.#.#.#.#.#.#.###########.#####.#
    #...#...#...#...#.#.#.#...#.....#...#.#.#.#.#.....###.#...###.#...#.#.#.###.#...#.....#.#.#...#.....#...#.#...#...#.#.#.#.....#...###.#.....#
    #########.#.#.###.#.#.#####.#####.#.#.#.#.#.#####.###.#.#####.#.#.#.#.#.###.#.###.#####.#.#.###.#####.###.#.#######.#.#.#####.#.#.###.#.#####
    #.........#...#...#.#.....#.#...#.#.#.#.#.#.#...#...#.#.#.....#.#.#.#.#...#.#...#...#...#.#.#...#...#.#...#.......#.#.#.#...#...#...#.#.....#
    #.#############.###.#####.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#####.#.#.#.###.#.###.###.#.###.#.#.###.#.#.#.#########.#.#.#.#.#.#######.#.#####.#
    #...............###.......#...#...#...#...#...#.....#...#.......#...#.....#.....###...###...#.....#...#...........#...#...#.........#.......#
    #############################################################################################################################################
    """;

    static char[][] parsedInput;
    static int maxY;
    static int maxX;

    public static void parseInput() {
        String[] splitInput = longInput.trim().split("\n");

        parsedInput = new char[splitInput.length][];

        for (int i = 0; i < splitInput.length; i++) {
            parsedInput[i] = splitInput[i].toCharArray();
        }
        maxY = parsedInput.length;
        maxX = parsedInput[0].length;
    }

    public static List<Point> findStartAndEndPoints() {
        List<Point> coordinates = new ArrayList<>(2);
        for (int y = 1; y < maxY - 1; y++) {
            for (int x = 1; x < maxX - 1; x++) {
                if (parsedInput[y][x] == 'S') {
                    coordinates.add(0, new Point(x, y));
                }
                if ( parsedInput[y][x] == 'E') {
                    coordinates.add(1, new Point(x, y));
                }
                if (coordinates.size() == 2) return coordinates;
            }
        }
        throw new IllegalStateException("Starting position not given");
    }

    static List<Point> DIRECTIONS = List.of(
        new Point(0, 1),  // North
        new Point(-1, 0), // East
        new Point(1, 0),  // West
        new Point(0, -1)  // South
    );

    public static void main(String[] args) {
        parseInput();
        List<Point> coords = findStartAndEndPoints();
        Point start = coords.get(0);
        Point end = coords.get(1);

        // Get distance from start to every point on the path
        Map<Point, Integer> distanceFromStart = bfsPath(start, end);
        
        System.err.println("Path length: " + distanceFromStart.size());

        Map<Integer, Integer> savingsCount = new HashMap<>();
        
        // For each point on the path
        for (Point current : distanceFromStart.keySet()) {
            for (Point other: distanceFromStart.keySet()) {
                if (current.equals(other)) continue;
                int dx = Math.abs(current.x - other.x);
                int dy = Math.abs(current.y - other.y);
                
                int manhattanDistance = dx + dy;
                if (manhattanDistance > 20) continue;

                int currentDist = distanceFromStart.get(current);
                int otherDist = distanceFromStart.get(other);

                int timeSaved = otherDist - currentDist - manhattanDistance;
                if (timeSaved >= 100) savingsCount.merge(timeSaved, 1, Integer::sum);
            }
        }
        
        // Print results
        int total = 0;
        for (Map.Entry<Integer, Integer> entry : new TreeMap<>(savingsCount).entrySet()) {
            total += entry.getValue();
            System.out.println("There are " + entry.getValue() + 
                            " cheats that save " + entry.getKey() + " picoseconds.");
        }
        System.out.println("There are " + total + " cheats which save 100 and more seconds.");
    }

    public static Map<Point, Integer> bfsPath(Point start, Point end) {
        Map<Point, Integer> distances = new HashMap<>();
        Queue<Point> queue = new LinkedList<>();
        
        distances.put(start, 0);
        queue.add(start);
        
        while (!queue.isEmpty()) {
            Point current = queue.poll();
            int currentDist = distances.get(current);
            
            if (!current.equals(end)) {
            } else {
                break;
            }
            
            for (Point dir : DIRECTIONS) {
                int newX = current.x + dir.x;
                int newY = current.y + dir.y;
                Point next = new Point(newX, newY);
                
                if (newX < 0 || newX >= maxX || newY < 0 || newY >= maxY) continue;
                if (parsedInput[newY][newX] == '#') continue;
                if (distances.containsKey(next)) continue;
                
                distances.put(next, currentDist + 1);
                queue.add(next);
            }
        }
        
        return distances;
    }
}
