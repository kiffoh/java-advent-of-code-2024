
import java.awt.Point;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;
import java.util.PriorityQueue;
import java.util.Queue;
import java.util.TreeMap;

class TwentyDup {

    // static String longInput = """
    // ###############
    // #...#...#.....#
    // #.#.#.#.#.###.#
    // #S#...#.#.#...#
    // #######.#.#.###
    // #######.#.#...#
    // #######.#.###.#
    // ###..E#...#...#
    // ###.#######.###
    // #...###...#...#
    // #.#####.#.###.#
    // #.#...#.#.#...#
    // #.#.#.#.#.#.###
    // #...#...#...###
    // ###############
    // """;

    static String longInput = """
    #############################################################################################################################################
    #...#.....#####.......#.....#...#...#...#...#.....#...#...###...#.......###...###...#...#####...#...###.......#...###...#...#...###.....#...#
    #.#.#.###.#####.#####.#.###.#.#.#.#.#.#.#.#.#.###.#.#.#.#.###.#.#.#####.###.#.###.#.#.#.#####.#.#.#.###.#####.#.#.###.#.#.#.#.#.###.###.#.#.#
    #.#.#...#...#...#.....#...#...#...#.#.#.#.#.#.#...#.#.#.#.#...#.#...#...#...#.....#.#.#...#...#.#.#...#...#...#.#...#.#...#.#.#...#...#.#.#.#
    #.#.###.###.#.###.#######.#########.#.#.#.#.#.#.###.#.#.#.#.###.###.#.###.#########.#.###.#.###.#.###.###.#.###.###.#.#####.#.###.###.#.#.#.#
    #.#.....#...#...#.......#.....#.....#.#...#.#.#...#.#.#.#...#...#...#...#.........#...#...#...#.#.#...#...#.#...#...#...#...#.#...#...#.#.#.#
    #.#######.#####.#######.#####.#.#####.#####.#.###.#.#.#.#####.###.#####.#########.#####.#####.#.#.#.###.###.#.###.#####.#.###.#.###.###.#.#.#
    #.......#.#.....#.......#...#.#.......#.....#.#...#.#.#.#...#...#...#...#...#...#.....#...#...#.#.#.###.#...#.#...#####.#...#.#...#...#.#.#.#
    #######.#.#.#####.#######.#.#.#########.#####.#.###.#.#.#.#.###.###.#.###.#.#.#.#####.###.#.###.#.#.###.#.###.#.#######.###.#.###.###.#.#.#.#
    #.......#.#...#...###...#.#.#.#.......#.###...#...#.#.#...#...#.....#...#.#.#.#.#...#...#.#.#...#.#.....#...#.#.....#...#...#...#...#.#.#.#.#
    #.#######.###.#.#####.#.#.#.#.#.#####.#.###.#####.#.#.#######.#########.#.#.#.#.#.#.###.#.#.#.###.#########.#.#####.#.###.#####.###.#.#.#.#.#
    #.......#.#...#.....#.#.#.#.#...#.....#...#...#...#.#.###...#.........#.#.#...#.#.#...#.#.#.#...#.....#.....#.#.....#.#...#...#...#...#...#.#
    #######.#.#.#######.#.#.#.#.#####.#######.###.#.###.#.###.#.#########.#.#.#####.#.###.#.#.#.###.#####.#.#####.#.#####.#.###.#.###.#########.#
    #.......#.#...#.....#.#...#...###.......#...#.#.#...#.#...#...###.....#.#.#.....#.#...#.#.#...#.......#.....#.#...#...#.#...#...#.....#.....#
    #.#######.###.#.#####.#######.#########.###.#.#.#.###.#.#####.###.#####.#.#.#####.#.###.#.###.#############.#.###.#.###.#.#####.#####.#.#####
    #.#.....#.....#.....#.......#.#...###...#...#.#.#...#.#.....#...#.#.....#.#.....#.#.#...#.#...#.............#...#.#.#...#.#.....#...#.#.....#
    #.#.###.###########.#######.#.#.#.###.###.###.#.###.#.#####.###.#.#.#####.#####.#.#.#.###.#.###.###############.#.#.#.###.#.#####.#.#.#####.#
    #...###.......#.....#...#...#.#.#...#.#...###.#.#...#...#...#...#.#...#...#.....#.#.#...#.#...#.....#...#...###.#...#.....#.......#...#.....#
    #############.#.#####.#.#.###.#.###.#.#.#####.#.#.#####.#.###.###.###.#.###.#####.#.###.#.###.#####.#.#.#.#.###.#######################.#####
    #...###.......#...###.#.#...#.#...#.#.#.#...#.#.#...#...#...#...#...#.#.#...#...#.#...#.#.#...#...#...#.#.#.....#.......#...#.....#...#.....#
    #.#.###.#########.###.#.###.#.###.#.#.#.#.#.#.#.###.#.#####.###.###.#.#.#.###.#.#.###.#.#.#.###.#.#####.#.#######.#####.#.#.#.###.#.#.#####.#
    #.#...#.........#...#.#.#...#...#.#...#.#.#...#.###.#.....#.#...###.#.#.#.....#.#...#...#...#...#.....#.#.....#...#...#...#...###...#.#.....#
    #.###.#########.###.#.#.#.#####.#.#####.#.#####.###.#####.#.#.#####.#.#.#######.###.#########.#######.#.#####.#.###.#.###############.#.#####
    #...#.#...#.....#...#.#.#...#...#...#...#.....#...#.....#...#.#...#.#.#.#.......###.#...#...#...#...#...###...#.#...#.#.....#.....###.#.....#
    ###.#.#.#.#.#####.###.#.###.#.#####.#.#######.###.#####.#####.#.#.#.#.#.#.#########.#.#.#.#.###.#.#.#######.###.#.###.#.###.#.###.###.#####.#
    #...#...#.#.....#.....#.....#.#...#.#.#...###...#...###.....#.#.#.#.#.#.#.#...#...#...#...#...#...#...#...#...#.#.#...#...#.#.#...#...#...#.#
    #.#######.#####.#############.#.#.#.#.#.#.#####.###.#######.#.#.#.#.#.#.#.#.#.#.#.###########.#######.#.#.###.#.#.#.#####.#.#.#.###.###.#.#.#
    #.......#.......#...........#.#.#.#.#.#.#.#...#.#...#.....#.#.#.#...#.#.#.#.#.#.#...###...#...#.......#.#.#...#.#.#.#.....#...#.###...#.#...#
    #######.#########.#########.#.#.#.#.#.#.#.#.#.#.#.###.###.#.#.#.#####.#.#.#.#.#.###.###.#.#.###.#######.#.#.###.#.#.#.#########.#####.#.#####
    #.....#...........#.........#.#.#.#.#.#.#.#.#...#.###...#.#.#.#.#.....#.#.#.#.#...#...#.#.#...#.#...#...#...#...#.#...#...#...#...###...#...#
    #.###.#############.#########.#.#.#.#.#.#.#.#####.#####.#.#.#.#.#.#####.#.#.#.###.###.#.#.###.#.#.#.#.#######.###.#####.#.#.#.###.#######.#.#
    #...#.............#.....#...#.#.#.#.#.#.#.#.....#...#...#.#.#.#.#...#...#...#.###...#.#.#...#.#...#.#.#.......#...#.....#...#...#.........#.#
    ###.#############.#####.#.#.#.#.#.#.#.#.#.#####.###.#.###.#.#.#.###.#.#######.#####.#.#.###.#.#####.#.#.#######.###.###########.###########.#
    #...#...#.......#...###...#.#.#.#.#.#.#.#.#...#...#.#...#.#.#.#.#...#.....#...#...#.#.#.#...#.#.....#.#.###.....#...###.......#...#...#.....#
    #.###.#.#.#####.###.#######.#.#.#.#.#.#.#.#.#.###.#.###.#.#.#.#.#.#######.#.###.#.#.#.#.#.###.#.#####.#.###.#####.#####.#####.###.#.#.#.#####
    #.....#...#...#...#.#...#...#...#...#.#.#...#.#...#.#...#.#.#.#.#.#.....#.#...#.#.#.#.#.#...#.#.#...#.#...#.#...#.....#.....#...#...#...#...#
    ###########.#.###.#.#.#.#.###########.#.#####.#.###.#.###.#.#.#.#.#.###.#.###.#.#.#.#.#.###.#.#.#.#.#.###.#.#.#.#####.#####.###.#########.#.#
    #.....###...#.....#...#...#.........#.#...#...#.###.#.###...#.#.#...#...#...#.#.#.#.#.#.###.#.#.#.#.#...#...#.#.......#...#.#...###...###.#.#
    #.###.###.#################.#######.#.###.#.###.###.#.#######.#.#####.#####.#.#.#.#.#.#.###.#.#.#.#.###.#####.#########.#.#.#.#####.#.###.#.#
    #...#.....#...#...........#.#.......#.#...#...#.#...#.....#...#...#...#...#.#.#.#...#.#.#...#.#.#.#.#...#...#...#...#...#...#.#...#.#.....#.#
    ###.#######.#.#.#########.#.#.#######.#.#####.#.#.#######.#.#####.#.###.#.#.#.#.#####.#.#.###.#.#.#.#.###.#.###.#.#.#.#######.#.#.#.#######.#
    #...#.......#...#.......#...#.......#.#...#...#.#.#...#...#...#...#...#.#.#.#.#...#...#.#.....#...#.#.#...#.....#.#.#.#.....#...#...#.....#.#
    #.###.###########.#####.###########.#.###.#.###.#.#.#.#.#####.#.#####.#.#.#.#.###.#.###.###########.#.#.#########.#.#.#.###.#########.###.#.#
    #.....#...#...###.....#.....#.......#.....#.....#...#.#.#...#...#.....#.#.#.#...#.#.#...#.....#...#...#...........#...#...#...........#...#.#
    #######.#.#.#.#######.#####.#.#######################.#.#.#.#####.#####.#.#.###.#.#.#.###.###.#.#.#######################.#############.###.#
    #.......#...#...###...#...#...#.............#...###...#...#.....#...#...#.#.#...#.#.#...#...#...#.................#.....#.....#...#...#.....#
    #.#############.###.###.#.#####.###########.#.#.###.###########.###.#.###.#.#.###.#.###.###.#####################.#.###.#####.#.#.#.#.#######
    #.............#.#...#...#.......###.......#...#...#.....#...#...#...#.#...#.#...#.#.#...###...#...#.........#...#...#...#.....#.#...#...#...#
    #############.#.#.###.#############.#####.#######.#####.#.#.#.###.###.#.###.###.#.#.#.#######.#.#.#.#######.#.#.#####.###.#####.#######.#.#.#
    #.............#...#...#.......#.....#...#.......#.....#...#.#...#...#.#.#...#...#.#.#.....###...#...#.......#.#.#...#.....#...#.#.......#.#.#
    #.#################.###.#####.#.#####.#.#######.#####.#####.###.###.#.#.#.###.###.#.#####.###########.#######.#.#.#.#######.#.#.#.#######.#.#
    #.....#...#.......#.#...#...#.#.....#.#.....#...#...#.....#...#.###.#.#.#...#.#...#.......#...........#...#...#...#.......#.#.#.#.###.....#.#
    #####.#.#.#.#####.#.#.###.#.#.#####.#.#####.#.###.#.#####.###.#.###.#.#.###.#.#.###########.###########.#.#.#############.#.#.#.#.###.#####.#
    #...#...#...#.....#.#.#...#.#.......#.#.....#.....#...#...#...#...#...#.#...#.#.#...........#...........#...#...........#...#...#.....#.....#
    #.#.#########.#####.#.#.###.#########.#.#############.#.###.#####.#####.#.###.#.#.###########.###############.#########.###############.#####
    #.#.###...###.......#.#.###...........#.###...###...#...###.....#...#...#.###...#.............#.............#.......#...#...............#...#
    #.#.###.#.###########.#.###############.###.#.###.#.###########.###.#.###.#####################.###########.#######.#.###.###############.#.#
    #.#.#...#.....#.....#...#.............#.....#.....#.........###...#.#...#...###.....###.......#.....#.....#...#...#.#.....#.......#.....#.#.#
    #.#.#.#######.#.###.#####.###########.#####################.#####.#.###.###.###.###.###.#####.#####.#.###.###.#.#.#.#######.#####.#.###.#.#.#
    #.#.#.....#...#...#...#...#.....#...#.............#.......#...#...#...#...#...#...#...#.....#.#...#...#...###...#.#.........#.....#...#...#.#
    #.#.#####.#.#####.###.#.###.###.#.#.#############.#.#####.###.#.#####.###.###.###.###.#####.#.#.#.#####.#########.###########.#######.#####.#
    #.#.###...#...###.#...#.....###...#.............#.#.....#.....#.......###...#...#...#.......#...#.#...#.........#.#.....#...#.........#...#.#
    #.#.###.#####.###.#.###########################.#.#####.###################.###.###.#############.#.#.#########.#.#.###.#.#.###########.#.#.#
    #.#.....#...#.....#.#...#.......................#.#...#.................###.....#...#...#.......#...#...#.......#...###...#.#...#...#...#.#.#
    #.#######.#.#######.#.#.#.#######################.#.#.#################.#########.###.#.#.#####.#######.#.#################.#.#.#.#.#.###.#.#
    #...#.....#.......#.#.#.#.#...................###...#...#...............#...#...#.#...#...#...#.......#.#.................#...#.#.#...###...#
    ###.#.###########.#.#.#.#.#.#################.#########.#.###############.#.#.#.#.#.#######.#.#######.#.#################.#####.#.###########
    ###.#...#.........#...#.#...###.......#...#...#...#...#...###########.....#...#.#...#...#...#...#.....#.............#...#.....#.#...........#
    ###.###.#.#############.#######.#####.#.#.#.###.#.#.#.###############.#########.#####.#.#.#####.#.#################.#.#.#####.#.###########.#
    #...#...#.#...#...#...#.#.......#...#...#.#.....#...#.....###########...#.......#.....#...#...#...#...#...........#...#.......#.............#
    #.###.###.#.#.#.#.#.#.#.#.#######.#.#####.###############.#############.#.#######.#########.#.#####.#.#.#########.###########################
    #...#.#...#.#...#...#.#...#.....#.#.#...#.....#...#.......###########...#.#.....#...........#...#...#.#.#.........#...#...#.........#...#...#
    ###.#.#.###.#########.#####.###.#.#.#.#.#####.#.#.#.#################.###.#.###.###############.#.###.#.#.#########.#.#.#.#.#######.#.#.#.#.#
    ###...#.....#...#...#.#.....###...#...#.....#.#.#.#...###############...#.#.#...###...#.......#.#.###...#...........#.#.#...#.......#.#.#.#.#
    #############.#.#.#.#.#.###################.#.#.#.###.#################.#.#.#.#####.#.#.#####.#.#.###################.#.#####.#######.#.#.#.#
    #...........#.#...#...#.#...................#...#...#.#################.#.#.#.#...#.#...#...#...#.#...................#.#.....#...#...#...#.#
    #.#########.#.#########.#.#########################.#.#################.#.#.#.#.#.#.#####.#.#####.#.###################.#.#####.#.#.#######.#
    #.........#...#...#...#.#...........#...........#...#.#################.#...#...#.#.......#.....#.#.......#.......#...#.#.#...#.#...#...#...#
    #########.#####.#.#.#.#.###########.#.#########.#.###.#################.#########.#############.#.#######.#.#####.#.#.#.#.#.#.#.#####.#.#.###
    #.....###.......#...#.#.#.........#...#.........#.#...#################.#.........###...#.......#.#...###...#.....#.#.#.#...#...#.....#...###
    #.###.###############.#.#.#######.#####.#########.#.###################.#.###########.#.#.#######.#.#.#######.#####.#.#.#########.###########
    #...#.....#...#...###...#.......#.....#.........#.#.#################S..#.........#...#...#...#...#.#...#...#.......#...#...#.....#.....#...#
    ###.#####.#.#.#.#.#############.#####.#########.#.#.#############################.#.#######.#.#.###.###.#.#.#############.#.#.#####.###.#.#.#
    ###.....#...#...#.......#.....#.....#.#...#...#.#...###############.......#...#...#.......#.#...###...#...#.........#...#.#.#.....#.#...#.#.#
    #######.###############.#.###.#####.#.#.#.#.#.#.###################.#####.#.#.#.#########.#.#########.#############.#.#.#.#.#####.#.#.###.#.#
    #...###.........#.......#...#.#.....#...#...#...###...#########.....#...#...#...###.....#.#...#.....#.#...........#.#.#...#.#.....#.#.#...#.#
    #.#.###########.#.#########.#.#.###################.#.#########.#####.#.###########.###.#.###.#.###.#.#.#########.#.#.#####.#.#####.#.#.###.#
    #.#.#...#.......#.#.....#...#...#...........###...#.#.#########...#...#...#.......#...#.#.#...#...#...#.#.....#...#...###...#.......#...#...#
    #.#.#.#.#.#######.#.###.#.#######.#########.###.#.#.#.###########.#.#####.#.#####.###.#.#.#.#####.#####.#.###.#.#########.###############.###
    #.#...#.#.......#.#.#...#...#.....#.........#...#...#.#########...#...#...#.#.....#...#.#...#...#.#.....#...#...#...#...#...#...#...#.....###
    #.#####.#######.#.#.#.#####.#.#####.#########.#######.#########.#####.#.###.#.#####.###.#####.#.#.#.#######.#####.#.#.#.###.#.#.#.#.#.#######
    #.#...#.........#.#.#...#...#...#...#.......#.......#...#######...###.#...#.#.....#...#...#...#.#.#.#.......#.....#...#.###...#...#.#.......#
    #.#.#.###########.#.###.#.#####.#.###.#####.#######.###.#########.###.###.#.#####.###.###.#.###.#.#.#.#######.#########.###########.#######.#
    #...#.#...#.....#...#...#.......#...#.#.....#...###...#.#######...#...#...#.#.....###.#...#...#.#...#.....#...#...#.....#...#...###.........#
    #####.#.#.#.###.#####.#############.#.#.#####.#.#####.#.#######.###.###.###.#.#######.#.#####.#.#########.#.###.#.#.#####.#.#.#.#############
    #.....#.#...#...#...#...#.....#...#...#...#...#...###.#.#######.....#...#...#.....#...#...#...#.#...#.....#.#...#.#.#...#.#...#.#...........#
    #.#####.#####.###.#.###.#.###.#.#.#######.#.#####.###.#.#############.###.#######.#.#####.#.###.#.#.#.#####.#.###.#.#.#.#.#####.#.#########.#
    #.......#...#.....#...#.#.#...#.#.......#...#.....#...#.#...#########.....#...#...#.#.....#...#...#.#.......#...#...#.#...#.....#.#.........#
    #########.#.#########.#.#.#.###.#######.#####.#####.###.#.#.###############.#.#.###.#.#######.#####.###########.#####.#####.#####.#.#########
    #...###...#...........#...#.###.......#.......#...#...#.#.#...#######.......#...#...#.###...#...#...#...#.....#.......#...#.......#.........#
    #.#.###.###################.#########.#########.#.###.#.#.###.#######.###########.###.###.#.###.#.###.#.#.###.#########.#.#################.#
    #.#.#...#.....#.......#...#...........#...#...#.#.#...#.#...#...#####.#.....#...#...#...#.#.#...#.#...#.#.###...#...#...#...#...#...#...#...#
    #.#.#.###.###.#.#####.#.#.#############.#.#.#.#.#.#.###.###.###.#####.#.###.#.#.###.###.#.#.#.###.#.###.#.#####.#.#.#.#####.#.#.#.#.#.#.#.###
    #.#.#.#...###...#.....#.#...#...#...###.#.#.#.#.#.#...#.###.#...###...#.#...#.#.###...#.#.#.#...#.#...#.#.....#.#.#.#.....#.#.#...#...#...###
    #.#.#.#.#########.#####.###.#.#.#.#.###.#.#.#.#.#.###.#.###.#.#####.###.#.###.#.#####.#.#.#.###.#.###.#.#####.#.#.#.#####.#.#.###############
    #.#...#.###.......#.....###...#...#...#.#.#.#.#.#.#...#.#...#.#..E#.#...#...#.#...#...#.#.#.#...#.#...#.......#...#.....#.#...#.....#...#...#
    #.#####.###.#######.#################.#.#.#.#.#.#.#.###.#.###.#.###.#.#####.#.###.#.###.#.#.#.###.#.###################.#.#####.###.#.#.#.#.#
    #...#...#...#.....#...#...............#.#...#.#.#.#.#...#...#.#...#...#...#.#.#...#.###.#.#.#.#...#.........#.........#.#.....#...#...#.#.#.#
    ###.#.###.###.###.###.#.###############.#####.#.#.#.#.#####.#.###.#####.#.#.#.#.###.###.#.#.#.#.###########.#.#######.#.#####.###.#####.#.#.#
    ###.#.###.#...###.....#...#...#...#...#...#...#.#.#.#.....#.#.#...###...#...#.#...#...#.#.#.#.#...#.......#...#...#...#.#...#.....#.....#.#.#
    ###.#.###.#.#############.#.#.#.#.#.#.###.#.###.#.#.#####.#.#.#.#####.#######.###.###.#.#.#.#.###.#.#####.#####.#.#.###.#.#.#######.#####.#.#
    #...#.#...#.#.............#.#.#.#...#.#...#.#...#.#.....#...#.#...#...#.....#.#...#...#...#...###.#.#.....#...#.#.#...#...#.......#.....#.#.#
    #.###.#.###.#.#############.#.#.#####.#.###.#.###.#####.#####.###.#.###.###.#.#.###.#############.#.#.#####.#.#.#.###.###########.#####.#.#.#
    #.....#.#...#...#.....#.....#.#...#...#...#.#.#...#...#.....#...#.#...#.#...#.#...#...###...#.....#.#.#...#.#...#.....#.......###.#.....#.#.#
    #######.#.#####.#.###.#.#####.###.#.#####.#.#.#.###.#.#####.###.#.###.#.#.###.###.###.###.#.#.#####.#.#.#.#.###########.#####.###.#.#####.#.#
    ###.....#.....#.#...#.#.#...#.....#...#...#...#.#...#...#...#...#.#...#.#...#...#...#.....#.#.....#.#.#.#.#.............#...#...#.#.......#.#
    ###.#########.#.###.#.#.#.#.#########.#.#######.#.#####.#.###.###.#.###.###.###.###.#######.#####.#.#.#.#.###############.#.###.#.#########.#
    #...#...#.....#...#.#...#.#...........#.#...#...#...###.#.###...#.#...#.###...#.###...#...#...#...#.#...#...#.......#.....#.#...#...#...#...#
    #.###.#.#.#######.#.#####.#############.#.#.#.#####.###.#.#####.#.###.#.#####.#.#####.#.#.###.#.###.#######.#.#####.#.#####.#.#####.#.#.#.###
    #.....#.#...#.....#.#.....#...#...#...#...#.#.#.....#...#...#...#.#...#...###.#...#...#.#.#...#.....###.....#.....#.#.....#.#.###...#.#.#...#
    #######.###.#.#####.#.#####.#.#.#.#.#.#####.#.#.#####.#####.#.###.#.#####.###.###.#.###.#.#.###########.#########.#.#####.#.#.###.###.#.###.#
    #.......#...#...#...#...#...#...#.#.#...#...#.#.....#...#...#.#...#.#...#...#.#...#.#...#.#.......#.....#...#...#.#.......#...#...#...#.#...#
    #.#######.#####.#.#####.#.#######.#.###.#.###.#####.###.#.###.#.###.#.#.###.#.#.###.#.###.#######.#.#####.#.#.#.#.#############.###.###.#.###
    #.#.....#.#...#...#...#...###.....#.#...#.#...#...#...#.#.#...#...#.#.#...#.#.#.###.#...#...#.....#...#...#...#.#.............#...#...#.#.###
    #.#.###.#.#.#.#####.#.#######.#####.#.###.#.###.#.###.#.#.#.#####.#.#.###.#.#.#.###.###.###.#.#######.#.#######.#############.###.###.#.#.###
    #.#.#...#.#.#.......#.......#.....#.#...#.#.#...#...#.#.#.#...#...#.#.#...#.#.#.#...#...#...#...#.....#.....#...#...#.........###.#...#.#...#
    #.#.#.###.#.###############.#####.#.###.#.#.#.#####.#.#.#.###.#.###.#.#.###.#.#.#.###.###.#####.#.#########.#.###.#.#.###########.#.###.###.#
    #.#.#.#...#.#...#.....#...#.......#.###...#.#.....#...#.#.#...#.###...#...#.#.#.#.#...#...#...#.#...#.....#.#.#...#.#.....#.....#.#...#.#...#
    #.#.#.#.###.#.#.#.###.#.#.#########.#######.#####.#####.#.#.###.#########.#.#.#.#.#.###.###.#.#.###.#.###.#.#.#.###.#####.#.###.#.###.#.#.###
    #.#.#.#.###...#...###...#...#.....#.......#.#.....###...#.#...#.....###...#.#.#.#.#.###...#.#.#...#...#...#.#.#...#.....#...#...#...#.#...###
    #.#.#.#.###################.#.###.#######.#.#.#######.###.###.#####.###.###.#.#.#.#.#####.#.#.###.#####.###.#.###.#####.#####.#####.#.#######
    #.#.#.#.#...................#.###...#...#.#.#.......#.#...#...#.....#...#...#.#.#.#.#.....#.#...#.....#...#.#...#.....#.#...#...#...#...#...#
    #.#.#.#.#.###################.#####.#.#.#.#.#######.#.#.###.###.#####.###.###.#.#.#.#.#####.###.#####.###.#.###.#####.#.#.#.###.#.#####.#.#.#
    #.#.#.#.#.......#...#...#.....#.....#.#.#.#.#.......#.#...#...#.....#.#...#...#.#...#.#...#...#.....#...#.#...#.#...#.#.#.#.....#.....#...#.#
    #.#.#.#.#######.#.#.#.#.#.#####.#####.#.#.#.#.#######.###.###.#####.#.#.###.###.#####.#.#.###.#####.###.#.###.#.#.#.#.#.#.###########.#####.#
    #...#...#...#...#.#.#.#...#.....#...#.#.#.#.#.....###.#...###.#...#.#.#.###.#...#.....#.#.#...#.....#...#.#...#...#.#.#.#.....#...###.#.....#
    #########.#.#.###.#.#.#####.#####.#.#.#.#.#.#####.###.#.#####.#.#.#.#.#.###.#.###.#####.#.#.###.#####.###.#.#######.#.#.#####.#.#.###.#.#####
    #.........#...#...#.#.....#.#...#.#.#.#.#.#.#...#...#.#.#.....#.#.#.#.#...#.#...#...#...#.#.#...#...#.#...#.......#.#.#.#...#...#...#.#.....#
    #.#############.###.#####.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#####.#.#.#.###.#.###.###.#.###.#.#.###.#.#.#.#########.#.#.#.#.#.#######.#.#####.#
    #...............###.......#...#...#...#...#...#.....#...#.......#...#.....#.....###...###...#.....#...#...........#...#...#.........#.......#
    #############################################################################################################################################
    """;

    static char[][] parsedInput;
    static int maxY;
    static int maxX;

    public static void parseInput() {
        String[] splitInput = longInput.trim().split("\n");

        parsedInput = new char[splitInput.length][];

        for (int i = 0; i < splitInput.length; i++) {
            parsedInput[i] = splitInput[i].toCharArray();
        }
        maxY = parsedInput.length;
        maxX = parsedInput[0].length;
    }

    public static List<Point> findStartPoint() {
        List<Point> coordinates = new ArrayList<>();
        for (int y = 1; y < maxY; y++) {
            for (int x = 1; x < maxX; x++) {
                if (parsedInput[y][x] == 'S' || parsedInput[y][x] == 'E') {
                    coordinates.add(new Point(x, y));
                    if (coordinates.size() == 2) return coordinates;
                }
            }
        }
        throw new IllegalStateException("Starting position not given");
    }

    static List<Point> DIRECTIONS = List.of(
        new Point(0, 1),  // North
        new Point(-1, 0), // East
        new Point(1, 0),  // West
        new Point(0, -1)  // South
    );

    static class Path {
        // I don't think I need to store direction
        int x, y, steps;
        Map<Point, Integer> distanceFromStart;

        public Path(int x, int y, int steps, Map<Point, Integer> distanceFromStart) {
            this.x = x;
            this.y = y;
            this.steps = steps;
            this.distanceFromStart = distanceFromStart;
            
        }
        public Path(int x, int y) {
            this.x = x;
            this.y = y;
            this.steps = 0;
            this.distanceFromStart = new HashMap<>();
        }
    }

    public static Map<Point, Integer> quickestPath(Point start, Point end) {
        PriorityQueue<Path> queue = new PriorityQueue<>((p1, p2) -> p2.distanceFromStart.size() - p1.distanceFromStart.size());
        queue.add(new Path(start.x, start.y));

        while (!queue.isEmpty()) {
            Path current = queue.poll();
            if (current.x == end.x && current.y == end.y) {
                return current.distanceFromStart;
            }
            for (Point dir: DIRECTIONS) {
                int newX = current.x + dir.x;
                int newY = current.y + dir.y;
                if (parsedInput[newY][newX] == '#' || current.distanceFromStart.containsKey(new Point(newX, newY))) {
                    continue;
                }
                Map<Point, Integer> newVisited = new HashMap<>(current.distanceFromStart);
                newVisited.put(new Point(newX, newY), current.steps + 1);
                queue.add(new Path(newX, newY, current.steps + 1, newVisited));
            }
        }
        throw new IllegalStateException("Valid path not available");
    }

    static Map<Point, Integer> enumeratedPath;
    static Map<Integer, Integer> picosMap = new TreeMap<>();

    public static void validateShortcut(Point coord, Point dir) {
        int endX = coord.x + dir.x * 2;
        int endY = coord.y + dir.y * 2;

        if (endX < 0 || endX >= maxX || endY < 0 || endY >= maxY) return;
        Point shortcutPoint = new Point(endX, endY);

        // End point must be valid
        if (parsedInput[shortcutPoint.y][shortcutPoint.x] == '#') {
            return;
        }

        // End point must be on valid path
        if (!enumeratedPath.containsKey(shortcutPoint)) return;

        int shortcutDistance = enumeratedPath.get(shortcutPoint);
        int originalDistance = enumeratedPath.get(coord);
        int timeSaved = shortcutDistance - originalDistance - 2;
        if (timeSaved > 0) {
            // System.err.println("coord: " + coord + " to shortcut " + shortcutPoint + " saves " + sum + " picoseconds");
            int picoseconds = picosMap.getOrDefault(timeSaved, 0);
            picosMap.put(timeSaved, picoseconds + 1);
        }
    }

    public static void main(String[] args) {
    parseInput();
    List<Point> coords = findStartPoint();
    Point start = coords.get(0);
    Point end = coords.get(1);

    // Get distance from start to every point on the path
    Map<Point, Integer> distanceFromStart = bfsPath(start, end);
    
    System.err.println("Path length: " + distanceFromStart.size());

    Map<Integer, Integer> savingsCount = new HashMap<>();
    
    // For each point on the path
    for (Point current : distanceFromStart.keySet()) {
        int currentDist = distanceFromStart.get(current);
        
        // Try all possible 2-step cheats (Manhattan distance = 2)
        for (int dx = -2; dx <= 2; dx++) {
            for (int dy = -2; dy <= 2; dy++) {
                // Manhattan distance must be exactly 2
                if (Math.abs(dx) + Math.abs(dy) != 2) continue;
                
                int newX = current.x + dx;
                int newY = current.y + dy;
                Point cheatEnd = new Point(newX, newY);
                
                // Check if cheat end is on the path
                if (!distanceFromStart.containsKey(cheatEnd)) continue;
                
                int cheatEndDist = distanceFromStart.get(cheatEnd);
                
                // Calculate time saved
                // Normal: cheatEndDist - currentDist steps to get there
                // With cheat: 2 steps
                int timeSaved = (cheatEndDist - currentDist) - 2;
                
                if (timeSaved > 100) {
                    savingsCount.merge(timeSaved, 1, Integer::sum);
                }
            }
        }
    }
    
    // Print results
    // int total = 0;
    for (Map.Entry<Integer, Integer> entry : new TreeMap<>(savingsCount).entrySet()) {
        // if (entry.getKey() >= 100 ) total += entry.getValue();
        System.out.println("There are " + entry.getValue() + 
                         " cheats that save " + entry.getKey() + " picoseconds.");
    }
    // System.out.println("There are " + total + " cheats which save 100 and more seconds.");
}

public static Map<Point, Integer> bfsPath(Point start, Point end) {
    Map<Point, Integer> distances = new HashMap<>();
    Queue<Point> queue = new LinkedList<>();
    
    distances.put(start, 0);
    queue.add(start);
    
    while (!queue.isEmpty()) {
        Point current = queue.poll();
        int currentDist = distances.get(current);
        
        if (!current.equals(end)) {
        } else {
            break;
        }
        
        for (Point dir : DIRECTIONS) {
            int newX = current.x + dir.x;
            int newY = current.y + dir.y;
            Point next = new Point(newX, newY);
            
            if (newX < 0 || newX >= maxX || newY < 0 || newY >= maxY) continue;
            if (parsedInput[newY][newX] == '#') continue;
            if (distances.containsKey(next)) continue;
            
            distances.put(next, currentDist + 1);
            queue.add(next);
        }
    }
    
    return distances;
}
}
