
import java.awt.RenderingHints;
import java.util.Map;
import java.util.HashMap;
import java.util.Set;
import java.util.HashSet;
import java.util.Collections;


public class Six {
    static Map<Integer, int[]> directions = Map.of(
        0, new int[]{-1, 0}, // Up
        1, new int[]{0, 1}, // Right
        2, new int[]{1, 0}, // Down
        3, new int[]{0, -1} // Left
    );

    static char[][] input;

    // static final char[][] input = new char[][] {
    //     { '.', '.', '.', '.', '#', '.', '.', '.', '.', '.' },
    //     { '.', '.', '.', '.', '.', '.', '.', '.', '.', '#' },
    //     { '.', '.', '.', '.', '.', '.', '.', '.', '.', '.' },
    //     { '.', '.', '#', '.', '.', '.', '.', '.', '.', '.' },
    //     { '.', '.', '.', '.', '.', '.', '.', '#', '.', '.' },
    //     { '.', '.', '.', '.', '.', '.', '.', '.', '.', '.' },
    //     { '.', '#', '.', '.', '^', '.', '.', '.', '.', '.' },
    //     { '.', '.', '.', '.', '.', '.', '.', '.', '#', '.' },
    //     { '#', '.', '.', '.', '.', '.', '.', '.', '.', '.' },
    //     { '.', '.', '.', '.', '.', '.', '#', '.', '.', '.' },
    // };

    // static final String inputString = """
    //     ....#.....
    //     .........#
    //     ..........
    //     ..#.......
    //     .......#..
    //     ..........
    //     .#..^.....
    //     ........#.
    //     #.........
    //     ......#...
    // """;

    static final String inputString = """
        #.....#.........#.........................#...#....................#......#.......#...........#........#..........................
        ..................#......#..................................#..................#....#...............#.#....................#.....#
        ..............#...........#......#.#.......................................#..................#......#............................
        ##...............................#..........#...................#.......#................................................#........
        #.....................#.......##................#...#..........#............................................#...#....#............
        ........#........#.............#...............#...##...................#...........#...........#.......#...........##.#...#.#....
        ................................................#....................................................#.#..........................
        .........#....#.....................................................................##......#.....#........#...............#......
        .............................#.....#.........#......................#...#................#.#..........#...........................
        ........................................#.........................................................................#...............
        .........................................#.......#.............#.#.........................#....#.....#...........#...............
        ...#............##...................................#...........#........................................#..................#....
        ....#.................#.......#............#.....#...........#................................#.#.#...........................#...
        ...#................................................................#.......................#.#........................#..#...#...
        ............................#......#.......#...............................................................................#....#.
        .......................................................#.............................#...#.......#.............#............#.....
        .....................................................................#......................................#.................##..
        ......#.................#......................................................#................#.................................
        ...............................................................................#...............#............................#.....
        ........................................................#......................##..................#........#.....................
        .#.................................#....#........#..#........#.................................#...............#..........#.#.....
        .................#................#...................#.#.....#................#..................#.........#.....................
        ...............#........................................................................#............#..........#.................
        ....................#..................#...........#................................#.....................#...#......#............
        .............#..#..................................#..............................#...............................#...#......#...#
        ..................#.............................................................#...............................#......#..........
        ................................................................#....#..............#.............................#...............
        .............#............#............................#...#........#...#.........................##..............................
        ....................................#....#.............#...#....#..........................#..................#.#............#....
        .......................#........................................................................................#.................
        ........#..................................#..#.........#.......................................#......#..............#...........
        ..........#............#............#..................#.......#..........#...................................#...........#.......
        ....#..............................#.....#...........##...#.....................#...........................#..........#..........
        ................................#..#.................................................................#...#...................#....
        ..#....................#..........................................................................#...............................
        ..................#........................#.......#..#......................................................................#....
        .#.....#......................#.....................................#.........................................#...................
        ..#....#...........................................#..........................................................................#...
        ..#.....#........................................................................#........#.#.............................#.......
        ................#......................................#...............#....................................#..........#..........
        ....................................#........................##.............................#..........................#........#.
        .#..............#..............................#......................................................#...........................
        ...#.#......................#.................#..................................#...........................#....................
        ..#....#..........................................#...#.......#..............................................#....................
        .......#.................#............................#..................................................#..#....................#
        .....##.#...........#...........................................#.....................................................#...........
        ................#.#........................................................................#..........#..#....#.##................
        ..........#........#............................................#.#......................................#.............#..........
        ............................................................#..........................................#..........................
        .......#........#.................#....................................................................#..........................
        ........................................................#..........................#..............#...............................
        .............#.#....................................#.................##............#.#.............................#..........#..
        .##.............................................^........#...................#.....#...................................#..........
        ...............#..#..#................................................................#...........................#...............
        .#.......##...........#.........#..................#......#..........#...#....#...................#...............................
        ....#................................................................#...................#........................................
        .........#............#..#......................................................#..#..............................................
        ...#.............................................................#......#....#....................................#...#....#......
        .....#.........#.................#....................#..................#..#.#.............#......#.....................#........
        ...........#.......#.##.#......#..#.............................#...........#..............................................#......
        ................................................................................................#.#......#......................#.
        ##..................................##....#.................#...............##....................................................
        .....#.............................#.............................................#................#.....................#.........
        ............#..............................#.....................#...............#..#....#....#...................................
        .........#.........................#...#................................................#........................................#
        .#..........................................#.......#.....................................................#..............#...#....
        #.........#...........#.............#..........................#........................................#.........................
        .......................................................................#.............................................#............
        ....#..............#..#......................................................#..........................................#....#....
        ........#...................................#...#................#.........................................................#...#..
        .........................................................#..#..#..#..........#...........#...........#............#...............
        ..............................................##......#.................#..............................................#..........
        .............................#..........#......#.....#....#.............#..............................................#...#..#...
        ......................................##......#.....................................#.......#....................#................
        ...................................................................................................#..............................
        .................................#..................................................................................#.............
        ........#...................................................................#...................##............#...................
        ...............................#..................................................................................................
        ...............................#...........................................................#...............##..............#......
        ........................................................................#..........#..................................#...........
        ................#.................................................................................................................
        ...#.................#..........#...........#...................................#......................#..........................
        .......................#..........................................................#.............#.............#..........#........
        ..........#..........#.#.................................#........#.............#..#..........................#........#.........#
        .................#.........#.#........................#...#.............................................................#......#..
        ......#.....................................................................#.....#...............#...............#....#..........
        ......#...##....#..#.......................................##......#......#....#..............#............#....................#.
        .#..........#........#...#........##..............#....#...........................#.....#................#...................#...
        .........................#........................................................................................................
        ..........................#.......................#.........#................................................#.#...........#......
        ......#...#.....#..........#....................#..................................#...#.................................#........
        .......................................................#............................#.....................#.#.................#...
        ..............#...............#......................#......#...................#.....................#.........#................#
        ....#.........#...............................................................#.......#.......#...........#.................#.....
        .......................#.........................#....................................#...........................................
        ...............#.................#..........#........................#...##.......................................................
        ....##..................#..#..................................................................................#.................#.
        ..................#.............#......................#...............#................#.#.......................................
        ........................#....#................................................#...#..........#....#.......#.......................
        .........................................................#..............#.............#.#.......#..................#......#...#...
        ...........#...........................#.........#..................................#.....................................#.......
        .#..........................................#................................................................#...........#........
        ..................................##....................#..........#..............#..........#............#.....#.................
        ##..#..#....#.........................................................#...............#...................................#.......
        ....#.#...........#............................#....#........#......#.............................................................
        #....#.........................#.............#.............................................................#.....#..#.............
        ............................#......#................#...............................................#.....#............#..........
        ........................#.............#..................#........................................................................
        ..#.............#........................................#.................................................#......................
        ...................#...................#..........#..#.............................................#...........#...#............#.
        ....#...#..........................##...#...............#....#.....................................#............#.................
        ..............................#..............................................................###..................................
        .................#......................................#.......................##.#............#.................................
        ............#.........................................#......##.....................#............#................................
        ....................#..#.............................#...#......................................#....................#.#........#.
        ....#...........#...........................................#....................................................#................
        ............#.....#..................................##.........#........#.....................................#..................
        ......#..............#..................................#...#.......#.............................................................
        ..........#.................#.......#.........................................................................#...........#.......
        ...........#..............#................#.....##.#............#........#.......................................................
        ................#.......................#.........................................................................#...........#...
        ..............................#............................................#.......#..............................................
        ..............#..............................#......#..................#....#.....#.................................#........#....
        ....................##..........#...#..#................#............#.......................#.................................#..
        ........................##.......#..................#.......#.....................#................#.....................#.....#..
        ..............#.............#...#......#.........#.................##..#...........#...........#.........................##.......
        #........#...........#........#..#............#...........#....#....#......##..............................................#......
        ........................................#.....................#....................................#........#......#......#.......
        .............#........#.............#...........#..#..#.......................................................#......#............
        #...................#.#........................................#..................................#...#...........................
    """;

    private static void convertInputStringToCharArray() {
        String[] splitLines = inputString.split("\n");
        input = new char[splitLines.length][];

        for (int i = 0; i < splitLines.length; i++) {
            input[i] = splitLines[i].toCharArray();
        }
    }

    static int maxRows;
    static int maxCols;

    // public static void checkNextStep(int row, int col, int currentDirection, Set<Point> prevSteps) {
        
    //     // Add current coordinates to prevSteps if not already in the path
    //     Point currentStep = new Point(row, col);
    //     if (!prevSteps.contains(currentStep)) {
    //         prevSteps.add(currentStep);
    //     }

    //     // Calculate nextStep with currentDirection
    //     int[] newDirections = directions.get(currentDirection);
    //     int newRow = row + newDirections[0];
    //     int newCol = col + newDirections[1];

    //     // System.out.println("newRow: " + newRow);
    //     // System.out.println("newCol: " + newCol);

    //     // If next step is an obstacle then the guard changes direction
    //     if (input[newRow][newCol] == '#') {
    //         // System.out.println("# Reached");
    //         // Change direction by 90 degrees 
    //         currentDirection = (currentDirection + 1) % 4;

    //         // checkNextStep in new direction with old coordinates
    //         checkNextStep(row, col, currentDirection, prevSteps);
    //         return;
    //     }

    //     // Checks for if puzzle finished in next step
    //     boolean upFinish = (currentDirection == 0) && (newRow == 0); // Current direction is up and the guard is at the top of the maze
    //     boolean rightFinish = (currentDirection == 1) && (newCol == maxCols - 1); // Current direction is right and the guard is at the RHS of the maze
    //     boolean downFinish = (currentDirection == 2) && (newRow == maxRows - 1); // Current direction is down and the guard is at the bottom of the maze
    //     boolean leftFinish = (currentDirection == 3) && (newCol == 0); // Current direction is left and the guard is at the LHS of the maze

    //     // If next step is not an obstacle and it is at the maximum points then the guard is out
    //     // E.g. the puzzle is complete
    //     if (upFinish || rightFinish || downFinish || leftFinish) {
    //         // Add the final step and exit the recursive loop
    //         Point nextStep = new Point(newRow, newCol);
    //         if (!prevSteps.contains(nextStep)) {
    //             prevSteps.add(nextStep);
    //         }
    //         return;
    //     }

    //     // If nextStep not an obstacle or the end then continue the step in with the same direction
    //     checkNextStep(newRow, newCol, currentDirection, prevSteps);
    // }

    public static void simulateGuardPath() {
        maxRows = input.length;
        maxCols = input[0].length;
        
        // Find the starting position
        int startRow = -1;
        int startCol = -1;
        for (int row = 0; row < maxRows; row++) {
            for (int col = 0; col < maxCols; col++) {
                if (input[row][col] == '^') {
                    startRow = row;
                    startCol = col;
                    break;
                }
            }
            if (startRow != -1) break;
        }
        
        if (startRow == -1 || startCol == -1) {
            System.out.println("No guard found on the map");
            return;
        }
        
        System.out.println("Guard starting at: Row " + startRow + ", Col " + startCol);
        
        // Track visited positions
        Set<Point> visited = new HashSet<>();
        
        // Starting position and direction
        int row = startRow;
        int col = startCol;
        int direction = 0; // Start facing up
        
        // Add starting position
        visited.add(new Point(row, col));
        
        // Main simulation loop
        while (true) {
            // Calculate next position
            int[] dir = directions.get(direction);
            int newRow = row + dir[0];
            int newCol = col + dir[1];
            
            // Check if we're leaving the map
            if (newRow < 0 || newRow >= maxRows || newCol < 0 || newCol >= maxCols) {
                System.out.println("Guard left the map at: Row " + newRow + ", Col " + newCol);
                break;
            }
            
            // Check if there's an obstacle
            if (input[newRow][newCol] == '#') {
                // Turn right
                direction = (direction + 1) % 4;
            } else {
                // Move forward
                row = newRow;
                col = newCol;
                visited.add(new Point(row, col));
            }
        }
        
        System.out.println("Total distinct positions visited: " + visited.size());
    }

    public static void main(String[] args) {
        convertInputStringToCharArray();
        simulateGuardPath();

        // maxRows = input.length;
        // maxCols = input[0].length;
        
        // Set<Point> path = new HashSet<>();
        // Map<String, Integer> visits = new HashMap<>();

        // for (int row = 0; row < maxRows; row++) {
        //     for (int col = 0; col < maxCols; col++) {
        //         if (input[row][col] == '^') {
        //             System.out.println("Row: " + row);
        //             System.out.println("Col: " + col);
        //             checkNextStep(row, col, 0, path);
        //         }
        //     }
        // }

        // System.out.println("Amount of steps: " + path.size());
    }
}

class Point {
    private final int x;
    private final int y;

    public Point(int x, int y) {
        this.x = x;
        this.y = y;
    }

    public int getX() { return x; }
    public int getY() { return y; }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        Point point = (Point) o;
        return x == point.x && y == point.y;
    }

    @Override
    public int hashCode() {
        return 31 * x + y;
    }
} 
